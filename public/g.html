<!doctype html>
<html lang="fr">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Test Three — Cube + Stars</title>
<style>
  html,body{height:100%;margin:0;background:#000;-webkit-user-select:none;user-select:none;font-family:system-ui;}
  #app{width:100%;height:100%;position:relative;overflow:hidden;}
  #status{position:fixed;left:12px;top:12px;padding:8px 10px;border-radius:8px;background:rgba(0,0,0,0.5);color:#cfe;z-index:10}
  canvas{display:block}
</style>
</head>
<body>
<div id="app"></div>
<div id="status">Test en cours… Ouvre la console (F12) si rien n'apparaît.</div>

<!-- Three.js UMD -->
<script src="https://unpkg.com/three@0.152.2/build/three.min.js"></script>

<script>
try {
  if (typeof THREE === 'undefined') throw new Error('Three.js non chargé (CDN).');

  const container = document.getElementById('app');
  const renderer = new THREE.WebGLRenderer({ antialias:true });
  renderer.setPixelRatio(Math.min(window.devicePixelRatio||1, 2));
  renderer.setSize(window.innerWidth, window.innerHeight);
  container.appendChild(renderer.domElement);

  const scene = new THREE.Scene();
  scene.background = new THREE.Color(0x000010);

  const camera = new THREE.PerspectiveCamera(60, innerWidth/innerHeight, 0.1, 1000);
  camera.position.set(0, 2, 8);

  // lights
  scene.add(new THREE.AmbientLight(0xffffff, 0.6));
  const sun = new THREE.PointLight(0xfff1cc, 1.2, 0, 2);
  sun.position.set(5,10,5);
  scene.add(sun);

  // stars
  (function makeStars(){
    const g = new THREE.BufferGeometry();
    const n = 1000;
    const pos = new Float32Array(n*3);
    for(let i=0;i<n;i++){
      pos[i*3] = (Math.random()-0.5) * 400;
      pos[i*3+1] = (Math.random()-0.5) * 200;
      pos[i*3+2] = (Math.random()-0.5) * 400;
    }
    g.setAttribute('position', new THREE.BufferAttribute(pos,3));
    const pts = new THREE.Points(g, new THREE.PointsMaterial({ size: 4, color: 0x99ddee }));
    scene.add(pts);
  })();

  // cube
  const geo = new THREE.BoxGeometry(1.6,1.6,1.6);
  const mat = new THREE.MeshStandardMaterial({ color: 0x2277ff, roughness:0.4, metalness:0.2 });
  const cube = new THREE.Mesh(geo, mat);
  scene.add(cube);

  // render loop
  let last = performance.now();
  function animate(){
    const now = performance.now();
    const dt = Math.min((now-last)/1000, 0.05);
    last = now;

    cube.rotation.x += dt * 0.7;
    cube.rotation.y += dt * 0.5;

    renderer.render(scene, camera);
    requestAnimationFrame(animate);
  }
  animate();

  window.addEventListener('resize', ()=>{
    camera.aspect = innerWidth/innerHeight;
    camera.updateProjectionMatrix();
    renderer.setSize(window.innerWidth, window.innerHeight);
  });

  document.getElementById('status').textContent = 'OK — cube affiché. Si OK, le moteur Three fonctionne.';
} catch(err){
  document.getElementById('status').textContent = 'Erreur: ' + err.message;
  console.error(err);
}
</script>
</body>
</html>
