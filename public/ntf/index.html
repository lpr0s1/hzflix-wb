<!doctype html>
<html lang="fr">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Kick Live â€” Notifications</title>

<!-- PushAlert -->
<script type="text/javascript">
(function(d, t) {
    var g = d.createElement(t),
        s = d.getElementsByTagName(t)[0];
    g.src = "https://cdn.pushalert.co/integrate_62438071d6f77622c49a1fd8e4e02698.js";
    s.parentNode.insertBefore(g, s);
}(document, "script"));
</script>

<!-- iOS PWA support -->
<meta name="apple-mobile-web-app-capable" content="yes" />
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
<meta name="apple-mobile-web-app-title" content="Kick Live Notifs" />
<link rel="apple-touch-icon" href="/icons/icon-192.png" />

<meta name="theme-color" content="#111827" />
<link rel="manifest" href="/ntf/manifest.webmanifest" id="manifest-link" />
<script src="https://cdn.tailwindcss.com"></script>

<script>
// Configuration minimale PWA/notifications
const ROOT_PATH = '/ntf/';
const CHANNEL_TITLE = "Je suis en live sur Kick ðŸŽ®";
const CHANNEL_BODY  = "Clique pour regarder â€” je suis live maintenant sur Kick!";

// GÃ©nÃ©ration du manifest inline
const manifest = {
    name: "Kick Live Notifs",
    short_name: "KickLive",
    start_url: ROOT_PATH,
    display: "standalone",
    background_color: "#111827",
    theme_color: "#111827",
    icons: [
        { src: ROOT_PATH + "/icons/icon-192.png", sizes: "192x192", type: "image/png" },
        { src: ROOT_PATH + "/icons/icon-512.png", sizes: "512x512", type: "image/png" }
    ]
};
document.getElementById('manifest-link').setAttribute('href', URL.createObjectURL(new Blob([JSON.stringify(manifest)], {type:'application/json'})));

// Enregistrement du Service Worker
async function registerSW() {
    if (!('serviceWorker' in navigator)) return;
    try {
        const reg = await navigator.serviceWorker.register(ROOT_PATH + 'sw.js', {scope: ROOT_PATH});
        await navigator.serviceWorker.ready;
        console.log('Service Worker enregistrÃ©:', reg.scope);
    } catch(e) {
        console.error('Erreur SW:', e);
    }
}

// Demande de permission notifications
async function enableNotifications() {
    try {
        const permission = await Notification.requestPermission();
        if (permission === 'granted') {
            await registerSW();
            console.log('Notifications activÃ©es');
        } else {
            console.log('Permission refusÃ©e');
        }
    } catch(e) {
        console.error('Erreur notifications:', e);
    }
}

document.addEventListener('DOMContentLoaded', () => {
    enableNotifications();
});
</script>
</head>
<body>
</body>
</html>
