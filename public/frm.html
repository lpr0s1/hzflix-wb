<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Mes lives films</title>
<style>
:root{--accent:lightgreen;--bg:linear-gradient(34deg,#333,black,#333);--ui-bg:rgba(0,0,0,0.6)}
html,body{height:100%;margin:0;background:var(--bg);font-family:Arial, Helvetica, sans-serif;color:#fff;-webkit-user-select:none;user-select:none}
.container{padding:20px}
h2{margin:0 0 16px 0;font-weight:600}
.wrap{position:relative;display:inline-block;border-radius:8px;border:2px solid var(--accent);box-shadow:0 0 12px var(--accent);background:#000;overflow:hidden}
.frame{display:block;width:100%;height:100%;border:0;pointer-events:none}
.overlay{position:absolute;inset:0;display:flex;align-items:flex-end;justify-content:space-between;padding:10px;box-sizing:border-box;pointer-events:none}
.controls{display:flex;gap:8px;z-index:60;pointer-events:auto}
.btn{background:var(--ui-bg);color:#fff;border:1px solid rgba(255,255,255,0.08);padding:8px 12px;border-radius:6px;cursor:pointer;font-weight:700;font-size:14px}
.btn:hover{background:rgba(255,255,255,0.04)}
.hint{position:absolute;left:12px;bottom:12px;background:rgba(0,0,0,0.45);padding:6px 10px;border-radius:6px;font-size:13px;z-index:50;pointer-events:none}
.responsive{width:350px;height:200px}
@media (min-width:800px){.responsive{width:800px;height:450px}}
:fullscreen .wrap, :-webkit-full-screen .wrap{width:100%!important;height:100%!important;border-radius:0!important}
.rotated{position:fixed!important;top:50%!important;left:50%!important;width:100vh!important;height:100vw!important;transform:translate(-50%,-50%) rotate(90deg)!important;transform-origin:center center!important;z-index:2147483647!important;border-radius:0!important}
.hide-others > *:not(.wrap){display:none!important}
.fullscreen-controls{position:fixed;z-index:2147483650;right:12px;top:12px;display:flex;gap:8px;pointer-events:auto}
.exit-btn{background:rgba(0,0,0,0.7);color:#fff;border:1px solid rgba(255,255,255,0.12);padding:10px 14px;border-radius:8px;cursor:pointer;font-weight:700}
</style>
</head>
<body>
<div class="container">
  <h2>test</h2>
  <div id="playerWrap" class="wrap responsive" role="region" aria-label="Lecteur live">
    <iframe id="kickFrame" class="frame" src="https://player.kick.com/hanzo-x65" scrolling="no" allow="autoplay; fullscreen; picture-in-picture" allowfullscreen title="Kick player"></iframe>
    <div class="overlay">
      <div class="controls">
        <button id="playBtn" class="btn">Play</button>
        <button id="fsBtn" class="btn">Fullscreen</button>
        <button id="openBtn" class="btn">Ouvrir Kick</button>
      </div>
    </div>
    <div class="hint" id="hint">Cliquer sur Play pour activer l'interaction</div>
  </div>
</div>
<div id="fsControls" class="fullscreen-controls" style="display:none">
  <button id="exitBtn" class="exit-btn">Exit</button>
</div>

<script>
(function(){
  const wrap=document.getElementById('playerWrap');
  const frame=document.getElementById('kickFrame');
  const playBtn=document.getElementById('playBtn');
  const fsBtn=document.getElementById('fsBtn');
  const openBtn=document.getElementById('openBtn');
  const exitBtn=document.getElementById('exitBtn');
  const fsControls=document.getElementById('fsControls');
  const hint=document.getElementById('hint');
  let interactive=false;
  let rotatedFallback=false;
  let lastScrollY=0;

  function calcSize(){
    const vw=window.innerWidth;
    const vh=window.innerHeight;
    const maxW=Math.min(Math.floor(vw*0.95),1280);
    const minW=Math.max(320,Math.floor(vw*0.6));
    const chosenW = vw<600?Math.max(320,Math.floor(vw*0.9)):Math.max(minW,Math.min(maxW,900));
    const ratio=16/9;
    let chosenH=Math.floor(chosenW/ratio);
    if(chosenH>Math.floor(vh*0.85)) chosenH=Math.floor(vh*0.85);
    wrap.style.width=chosenW+'px';
    wrap.style.height=chosenH+'px';
  }

  calcSize();
  window.addEventListener('resize',calcSize);
  window.addEventListener('orientationchange',calcSize);

  function enableInteraction(){
    interactive=true;
    frame.style.pointerEvents='auto';
    hint.style.display='none';
    playBtn.textContent='Pause';
  }
  function disableInteraction(){
    interactive=false;
    frame.style.pointerEvents='none';
    hint.style.display='';
    playBtn.textContent='Play';
  }

  playBtn.addEventListener('click',function(){
    if(!interactive) enableInteraction();
    else disableInteraction();
  });

  openBtn.addEventListener('click',function(){
    window.open('https://kick.com/hanzo-x65','_blank','noopener');
  });

  function tryLockLandscape(){
    if(screen.orientation && screen.orientation.lock){
      return screen.orientation.lock('landscape').then(()=>true).catch(()=>Promise.reject());
    }
    if(screen.lockOrientationUniversal){
      try{
        const ok=screen.lockOrientationUniversal('landscape');
        return Promise.resolve(!!ok);
      }catch(e){
        return Promise.reject();
      }
    }
    return Promise.reject();
  }

  function applyRotatedFallback(){
    rotatedFallback=true;
    lastScrollY=window.scrollY||window.pageYOffset||0;
    document.body.classList.add('hide-others');
    wrap.classList.add('rotated');
    fsControls.style.display='flex';
    requestAnimationFrame(()=>{});
  }

  function removeRotatedFallback(){
    rotatedFallback=false;
    document.body.classList.remove('hide-others');
    wrap.classList.remove('rotated');
    fsControls.style.display='none';
    window.scrollTo(0,lastScrollY);
  }

  function enterFullscreenMode(){
    document.documentElement.requestFullscreen?.call(document.documentElement).catch(()=>{});
    wrap.requestFullscreen?.call(wrap).catch(()=>{});
    wrap.webkitRequestFullscreen?.call(wrap);
    fsControls.style.display='flex';
    document.body.classList.add('hide-others');
  }

  function exitFullscreenMode(){
    document.exitFullscreen?.call(document).catch(()=>{});
    document.webkitExitFullscreen?.call(document);
    fsControls.style.display='none';
    document.body.classList.remove('hide-others');
  }

  fsBtn.addEventListener('click',function(){
    tryLockLandscape().then(()=>{
      enterFullscreenMode();
      fsControls.style.display='flex';
    }).catch(()=>{
      try{
        enterFullscreenMode();
        applyRotatedFallback();
      }catch(e){
        applyRotatedFallback();
      }
    });
    enableInteraction();
  });

  exitBtn.addEventListener('click',function(){
    try{
      if(screen.orientation && screen.orientation.unlock) screen.orientation.unlock();
    }catch(e){}
    exitFullscreenMode();
    if(rotatedFallback) removeRotatedFallback();
  });

  document.addEventListener('fullscreenchange',function(){
    const isFS=!!(document.fullscreenElement||document.webkitFullscreenElement);
    if(!isFS){
      try{ if(screen.orientation && screen.orientation.unlock) screen.orientation.unlock(); }catch(e){}
      if(rotatedFallback) removeRotatedFallback();
      fsControls.style.display='none';
      document.body.classList.remove('hide-others');
    } else {
      fsControls.style.display='flex';
    }
  });

  document.addEventListener('keydown',function(e){
    const k=e.key.toLowerCase();
    if(k==='f'){
      fsBtn.click();
    }
    if(k==='escape'){
      exitBtn.click();
    }
  });

  window.addEventListener('beforeunload',function(){
    try{ if(screen.orientation && screen.orientation.unlock) screen.orientation.unlock(); }catch(e){}
  });

  disableInteraction();
})();
</script>
</body>
</html>

